# 인터럽트(Interrupt)

done: Yes
날짜: 2023년 1월 14일

## 인터럽트란

---

프로그램 실행중 우선순위가 더 높은 일이 발생 시 작업을 중단하고 우선 처리가 필요함을 CPU에 알리는 것

## 인터럽트 종류

---

인터럽트라인을 누가 세팅하냐에 따라 두 가지로 나뉨

> 내/외부 인터럽트는 CPU의 하드웨어 신호에 의해 발생
> 

### 하드웨어 인터럽트

일반적으로 인터럽트는 하드웨어 인터럽트를 말함

내부 인터럽트(Trap) : 잘못된 명령이나 데이터 사용시 발생

외부 인터럽트 : 외부요인에 의해 발생

- 전원 이상( Power Fall Interrupt) : 전원공급의 이상
- 기계착오 (Machine check interrupt) : CPU의 기능적 오류
- 외부 신호 (External interrupt): 오퍼레이터나 타이머에 의해 의도적으로 프로그래밍이 중단된경우
- 입출력(I/O interrupt) : 입출력 작업의 종류나 오류(키보드,프린터,모니터)

> 소프트웨어 인터럽트는 명령어의 수행에 의해 발생
> 

### 소프트웨어 인터럽트

프로그램 처리 중 명령어의 요청에 의해 발생한 것 

- Exception 프로그램 오류
- System Call 개별 프로그램이 본인이 할 수 없는 일을 운영체제에게 부탁. 커널함수 호출

**소프트웨어 인터럽트 종류**

- 프로그램 검사 인터럽트 : 0으로 나눈 경우, 오버 플로우 언더플로우, 페이지 부재 등
- SVC인터럽트(Supervisor Call 검사프로그램 호출)
    - 사용자가 프로그램을 실행시키거나 검사프로그램을 호출할 때 발생
    소프트웨어 이용 중에 다른 프로세스를 실행시키면 시분할 처리를 위해 자원 할당 동작이 수행된다.
    - 프로그래머에 의해 코드로 짜인 감시프로그램을 호출하는 방식

## 인터럽트 처리과정

![D3BA8F12-C137-4B54-8370-A8214D5E84D9.png](%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%90%E1%85%A5%E1%84%85%E1%85%A5%E1%86%B8%E1%84%90%E1%85%B3(Interrupt)%20f5095959725d43dabaf9bc9118532491/D3BA8F12-C137-4B54-8370-A8214D5E84D9.png)

1. 프로세스 A 실행 중
2. A가 system call을 통해 인터럽트 발생
3. 현재까지 수행중이던 프로세스의 PCB(process control block)에 수행중이던 메모리 주소, 레지스터 값 등을 스택에 저장
4. 인터럽트 벡터를 읽고 ISR주소값을 읽어 ISR(Interrupt Service Routine)로 점프
5. 해당 코드를 실행
6. 완료
7. 저장했던 프로세스 상태 복구. 
8. ISR 끝에 IRET명령어에 의해 인터럽트가 해제.
9. IRET명령어가 실행되면 대피시킨 PC값을 복원하여 이전 실행 위치로

- 인터럽트 처리과정이 없을 때에는 컨트롤러는 풀링(Pilling)을 계속 해야한다.
- 풀링은 특정한 어떤 일을 할 시기를 계속 체크하는 것인데 원래 하던 작업에 집중하지 못해 많은 기능을 제대로 수행하지 못하는 단점이 있다

## 컨트롤러가 입력을 받는 방법(우선순위 판별 방법)

### 폴링

- 사용자가 명령어를 통해 (핀의 값을 계속 읽어) 변화를 알아내는 방식
- 인터럽트 요청 플래그를 차례로 비교하여 우선순위가 높은 인터럽트 자원을 찾아 이에 맞는 인처럽트 서비스 루틴을 수행
    - 하드웨어에 비해 속도가 느리다

### 인터럽트 방식

- MCU자체가 하드웨어적으로 변화를 체크하여 변화시에만 일정한 동작을 하는 방식
    - Daisy chain
    - 병렬 우선순위 부여
- 하드웨어로 자원을 받아야하는 제약사항이 있지만 폴링에 비해 빠름
    - 실시간 대처에 필수적인 기능

### 즉, 인터럽트는 **발생시기를 예측하기 힘든 경우에 컨트롤러가 가장 빠르게 대응할 수 있는 방법**
이다.

# 질문

---

1. 인터럽트?
2. 인터럽트의 종류?
3. 소프트웨어 인터럽트의 종류?
4. 인터럽트 발생과정 
5. 인터럽트방식?